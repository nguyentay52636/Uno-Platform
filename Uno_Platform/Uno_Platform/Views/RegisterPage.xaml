<Page x:Class="Uno_Platform.Views.RegisterPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="using:Uno_Platform.Views"
      xmlns:components="using:Uno_Platform.Components"
      Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
  <Grid x:Name="RootGrid">
    <!-- Background Gradient (same as LoginPage) -->
    <Grid.Background>
      <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
        <GradientStop Color="#F8FAFC" Offset="0"/>
        <GradientStop Color="#E2E8F0" Offset="1"/>
      </LinearGradientBrush>
    </Grid.Background>

    <!-- Visual States for Responsive Design -->
    <VisualStateManager.VisualStateGroups>
      <VisualStateGroup x:Name="AdaptiveStates">
        <!-- Large screens (Desktop) -->
        <VisualState x:Name="WideState">
          <VisualState.StateTriggers>
            <AdaptiveTrigger MinWindowWidth="720"/>
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="RegisterCard.Width" Value="400"/>
            <Setter Target="RegisterCard.Padding" Value="40"/>
            <Setter Target="ContentWrapper.Padding" Value="20"/>
            <Setter Target="HeaderIcon.Width" Value="64"/>
            <Setter Target="HeaderIcon.Height" Value="64"/>
            <Setter Target="HeaderIcon.CornerRadius" Value="32"/>
            <Setter Target="HeaderIconSymbol.RenderTransform" Value="{StaticResource LargeIconTransform}"/>
            <Setter Target="BackButton.Margin" Value="-20,-20,0,0"/>
            <Setter Target="FormContent.Spacing" Value="24"/>
          </VisualState.Setters>
        </VisualState>

        <!-- Medium screens (Tablet) -->
        <VisualState x:Name="MediumState">
          <VisualState.StateTriggers>
            <AdaptiveTrigger MinWindowWidth="480"/>
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="RegisterCard.Width" Value="380"/>
            <Setter Target="RegisterCard.Padding" Value="32"/>
            <Setter Target="ContentWrapper.Padding" Value="16"/>
            <Setter Target="HeaderIcon.Width" Value="56"/>
            <Setter Target="HeaderIcon.Height" Value="56"/>
            <Setter Target="HeaderIcon.CornerRadius" Value="28"/>
            <Setter Target="HeaderIconSymbol.RenderTransform" Value="{StaticResource MediumIconTransform}"/>
            <Setter Target="BackButton.Margin" Value="-16,-16,0,0"/>
            <Setter Target="FormContent.Spacing" Value="20"/>
          </VisualState.Setters>
        </VisualState>

        <!-- Small screens (Mobile 360-479px) -->
        <VisualState x:Name="NarrowState">
          <VisualState.StateTriggers>
            <AdaptiveTrigger MinWindowWidth="360"/>
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="RegisterCard.Width" Value="NaN"/>
            <Setter Target="RegisterCard.HorizontalAlignment" Value="Stretch"/>
            <Setter Target="RegisterCard.Padding" Value="24,28"/>
            <Setter Target="RegisterCard.CornerRadius" Value="16"/>
            <Setter Target="ContentWrapper.Padding" Value="16,20"/>
            <Setter Target="HeaderIcon.Width" Value="52"/>
            <Setter Target="HeaderIcon.Height" Value="52"/>
            <Setter Target="HeaderIcon.CornerRadius" Value="26"/>
            <Setter Target="HeaderIcon.Margin" Value="0,0,0,12"/>
            <Setter Target="HeaderIconSymbol.RenderTransform" Value="{StaticResource SmallIconTransform}"/>
            <Setter Target="BackButton.Margin" Value="-12,-12,0,0"/>
            <Setter Target="FormContent.Spacing" Value="16"/>
            <Setter Target="WelcomeText.FontSize" Value="22"/>
            <Setter Target="SubtitleText.FontSize" Value="13"/>
          </VisualState.Setters>
        </VisualState>

        <!-- Extra Small screens (Mobile &lt;360px) -->
        <VisualState x:Name="ExtraSmallState">
          <VisualState.StateTriggers>
            <AdaptiveTrigger MinWindowWidth="0"/>
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="RegisterCard.Width" Value="NaN"/>
            <Setter Target="RegisterCard.HorizontalAlignment" Value="Stretch"/>
            <Setter Target="RegisterCard.Padding" Value="16,20"/>
            <Setter Target="RegisterCard.CornerRadius" Value="12"/>
            <Setter Target="ContentWrapper.Padding" Value="12,16"/>
            <Setter Target="HeaderIcon.Width" Value="44"/>
            <Setter Target="HeaderIcon.Height" Value="44"/>
            <Setter Target="HeaderIcon.CornerRadius" Value="22"/>
            <Setter Target="HeaderIcon.Margin" Value="0,0,0,8"/>
            <Setter Target="HeaderIconSymbol.RenderTransform" Value="{StaticResource SmallIconTransform}"/>
            <Setter Target="BackButton.Margin" Value="-8,-8,0,0"/>
            <Setter Target="FormContent.Spacing" Value="12"/>
            <Setter Target="WelcomeText.FontSize" Value="20"/>
            <Setter Target="SubtitleText.FontSize" Value="12"/>
          </VisualState.Setters>
        </VisualState>
      </VisualStateGroup>
    </VisualStateManager.VisualStateGroups>

    <!-- Resources for transforms -->
    <Grid.Resources>
      <ScaleTransform x:Key="LargeIconTransform" ScaleX="1.5" ScaleY="1.5"/>
      <ScaleTransform x:Key="MediumIconTransform" ScaleX="1.3" ScaleY="1.3"/>
      <ScaleTransform x:Key="SmallIconTransform" ScaleX="1.1" ScaleY="1.1"/>
    </Grid.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto"
                  HorizontalScrollBarVisibility="Disabled">
      <StackPanel x:Name="ContentWrapper"
                  HorizontalAlignment="Center" 
                  VerticalAlignment="Center"
                  Padding="20"
                  MaxWidth="440">
        
        <!-- Register Card -->
        <Border x:Name="RegisterCard"
                Background="{StaticResource SurfaceBrush}"
                CornerRadius="{StaticResource BorderRadiusLarge}"
                Padding="40"
                Width="400"
                MaxWidth="440"
                BorderBrush="{StaticResource BorderBrush}"
                BorderThickness="1"
                Shadow="{StaticResource SharedShadow}"
                Translation="0,0,32">
          <Border.Resources>
            <ThemeShadow x:Name="SharedShadow"/>
          </Border.Resources>

          <StackPanel x:Name="FormContent" Spacing="24">
            <!-- Header -->
            <Grid>
                <Button x:Name="BackButton"
                        Click="BackButton_Click"
                        Style="{StaticResource IconButtonStyle}"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Top"
                        Margin="-20,-20,0,0">
                    <SymbolIcon Symbol="Back"/>
                </Button>
                
                <StackPanel Spacing="8" HorizontalAlignment="Center" Margin="0,0,0,8">
                  <Border x:Name="HeaderIcon"
                          Width="64" 
                          Height="64" 
                          CornerRadius="32" 
                          Background="{StaticResource PrimaryGradientBrush}"
                          Margin="0,0,0,16"
                          HorizontalAlignment="Center">
                    <SymbolIcon x:Name="HeaderIconSymbol" 
                                Symbol="AddFriend" 
                                Foreground="White" 
                                RenderTransformOrigin="0.5,0.5">
                      <SymbolIcon.RenderTransform>
                        <ScaleTransform ScaleX="1.5" ScaleY="1.5"/>
                      </SymbolIcon.RenderTransform>
                    </SymbolIcon>
                  </Border>
                  
                  <TextBlock x:Name="WelcomeText"
                             Text="Tạo tài khoản" 
                             Style="{StaticResource Heading2Style}"
                             HorizontalAlignment="Center"
                             TextAlignment="Center"/>
                  
                  <TextBlock x:Name="SubtitleText"
                             Text="Đăng ký để bắt đầu" 
                             Style="{StaticResource SecondaryTextStyle}"
                             HorizontalAlignment="Center"
                             TextAlignment="Center"/>
                </StackPanel>
            </Grid>

            <!-- Form -->
            <StackPanel Spacing="16">
              <!-- Full Name -->
              <StackPanel Spacing="8">
                <TextBlock Text="Họ và tên" 
                           Style="{StaticResource BodyTextStyle}" 
                           FontWeight="SemiBold"/>
                <TextBox x:Name="FullNameTextBox"
                         PlaceholderText="Nhập họ và tên"
                         Style="{StaticResource ModernTextBoxStyle}"
                         HorizontalAlignment="Stretch"
                         MinHeight="44"/>
              </StackPanel>

              <!-- Email -->
              <StackPanel Spacing="8">
                <TextBlock Text="Email" 
                           Style="{StaticResource BodyTextStyle}" 
                           FontWeight="SemiBold"/>
                <TextBox x:Name="EmailTextBox"
                         PlaceholderText="Nhập địa chỉ email"
                         Style="{StaticResource ModernTextBoxStyle}"
                         HorizontalAlignment="Stretch"
                         MinHeight="44"/>
              </StackPanel>

              <!-- Username -->
              <StackPanel Spacing="8">
                <TextBlock Text="Tên đăng nhập" 
                           Style="{StaticResource BodyTextStyle}" 
                           FontWeight="SemiBold"/>
                <TextBox x:Name="UsernameTextBox"
                         PlaceholderText="Nhập tên đăng nhập"
                         Style="{StaticResource ModernTextBoxStyle}"
                         HorizontalAlignment="Stretch"
                         MinHeight="44"/>
              </StackPanel>

              <!-- Password with Show/Hide -->
              <StackPanel Spacing="8">
                <TextBlock Text="Mật khẩu" 
                           Style="{StaticResource BodyTextStyle}" 
                           FontWeight="SemiBold"/>
                <Grid>
                  <PasswordBox x:Name="PasswordBox"
                               PlaceholderText="Nhập mật khẩu"
                               Height="48"
                               BorderBrush="{StaticResource BorderBrush}"
                               BorderThickness="2"
                               CornerRadius="{StaticResource BorderRadiusMedium}"
                               Padding="10,10,50,10"
                               HorizontalAlignment="Stretch"
                               Visibility="Visible"/>
                  <TextBox x:Name="PasswordTextBox"
                           PlaceholderText="Nhập mật khẩu"
                           Height="48"
                           BorderBrush="{StaticResource BorderBrush}"
                           BorderThickness="2"
                           CornerRadius="{StaticResource BorderRadiusMedium}"
                           Padding="10,10,50,10"
                           HorizontalAlignment="Stretch"
                           Visibility="Collapsed"/>
                  <Button x:Name="TogglePasswordButton"
                          Click="TogglePasswordVisibility_Click"
                          Tag="Password"
                          Background="Transparent"
                          BorderThickness="0"
                          Width="44"
                          Height="44"
                          HorizontalAlignment="Right"
                          VerticalAlignment="Center"
                          Margin="0,0,4,0">
                    <SymbolIcon x:Name="PasswordEyeIcon" Symbol="View" Foreground="#6B7280"/>
                  </Button>
                </Grid>
              </StackPanel>

              <!-- Confirm Password with Show/Hide -->
              <StackPanel Spacing="8">
                <TextBlock Text="Xác nhận mật khẩu" 
                           Style="{StaticResource BodyTextStyle}" 
                           FontWeight="SemiBold"/>
                <Grid>
                  <PasswordBox x:Name="ConfirmPasswordBox"
                               PlaceholderText="Nhập lại mật khẩu"
                               Height="48"
                               BorderBrush="{StaticResource BorderBrush}"
                               BorderThickness="2"
                               CornerRadius="{StaticResource BorderRadiusMedium}"
                               Padding="10,10,50,10"
                               HorizontalAlignment="Stretch"
                               Visibility="Visible"/>
                  <TextBox x:Name="ConfirmPasswordTextBox"
                           PlaceholderText="Nhập lại mật khẩu"
                           Height="48"
                           BorderBrush="{StaticResource BorderBrush}"
                           BorderThickness="2"
                           CornerRadius="{StaticResource BorderRadiusMedium}"
                           Padding="10,10,50,10"
                           HorizontalAlignment="Stretch"
                           Visibility="Collapsed"/>
                  <Button x:Name="ToggleConfirmPasswordButton"
                          Click="TogglePasswordVisibility_Click"
                          Tag="ConfirmPassword"
                          Background="Transparent"
                          BorderThickness="0"
                          Width="44"
                          Height="44"
                          HorizontalAlignment="Right"
                          VerticalAlignment="Center"
                          Margin="0,0,4,0">
                    <SymbolIcon x:Name="ConfirmPasswordEyeIcon" Symbol="View" Foreground="#6B7280"/>
                  </Button>
                </Grid>
              </StackPanel>
            </StackPanel>

            <!-- Error Message -->
            <TextBlock x:Name="ErrorMessageText"
                       Foreground="{StaticResource ErrorBrush}"
                       FontSize="{StaticResource FontSizeSmall}"
                       TextWrapping="Wrap"
                       HorizontalAlignment="Center"
                       TextAlignment="Center"
                       Visibility="Collapsed"
                       Margin="0,8,0,0"/>

            <!-- Register Button -->
            <Button x:Name="RegisterButton"
                    Content="Đăng ký" 
                    Click="RegisterButton_Click"
                    Style="{StaticResource PrimaryButtonStyle}"
                    HorizontalAlignment="Stretch"
                    MinHeight="48"
                    Margin="0,8,0,0"/>
            
            <!-- Login Link -->
            <StackPanel Spacing="8" Margin="0,12,0,0">
              <TextBlock Text="Đã có tài khoản?" 
                         FontSize="{StaticResource FontSizeSmall}"
                         Foreground="{StaticResource TextSecondaryBrush}"
                         HorizontalAlignment="Center"
                         TextAlignment="Center"/>
              <Button x:Name="LoginLinkButton"
                      Content="Đăng nhập ngay"
                      Click="LoginLinkButton_Click"
                      Background="Transparent"
                      BorderThickness="0"
                      Foreground="{StaticResource PrimaryBrush}"
                      FontWeight="SemiBold"
                      HorizontalAlignment="Center"/>
            </StackPanel>
          </StackPanel>
        </Border>
      </StackPanel>
    </ScrollViewer>
    
    <!-- Loading Indicator Overlay -->
    <Border x:Name="LoadingOverlay"
            Background="#80000000"
            Visibility="Collapsed">
      <StackPanel HorizontalAlignment="Center" 
                  VerticalAlignment="Center"
                  Spacing="16">
        <ProgressRing IsActive="True" 
                      Width="48" 
                      Height="48"
                      Foreground="White"/>
        <TextBlock Text="Đang tạo tài khoản..."
                   Foreground="White"
                   FontSize="16"
                   HorizontalAlignment="Center"/>
      </StackPanel>
    </Border>
  </Grid>
</Page>