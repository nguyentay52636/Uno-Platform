<Page x:Class="Uno_Platform.Views.AppShell"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:views="using:Uno_Platform.Views"
      Background="{StaticResource BackgroundGradientBrush}">
  
  <Page.Resources>
    <!-- Tab Transition Animations -->
    <Storyboard x:Key="PageEnterAnimation">
      <DoubleAnimation Storyboard.TargetName="ContentFrame"
                      Storyboard.TargetProperty="Opacity"
                      From="0"
                      To="1"
                      Duration="0:0:0.3">
        <DoubleAnimation.EasingFunction>
          <CubicEase EasingMode="EaseOut"/>
        </DoubleAnimation.EasingFunction>
      </DoubleAnimation>
      <DoubleAnimation Storyboard.TargetName="ContentFrame"
                      Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)"
                      From="20"
                      To="0"
                      Duration="0:0:0.3">
        <DoubleAnimation.EasingFunction>
          <CubicEase EasingMode="EaseOut"/>
        </DoubleAnimation.EasingFunction>
      </DoubleAnimation>
    </Storyboard>
  </Page.Resources>

  <VisualStateManager.VisualStateGroups>
    <VisualStateGroup x:Name="AdaptiveStates">
      <VisualState x:Name="Mobile">
        <VisualState.StateTriggers>
          <AdaptiveTrigger MinWindowWidth="0"/>
        </VisualState.StateTriggers>
        <VisualState.Setters>
          <Setter Target="AppBar.Padding" Value="12,8"/>
          <Setter Target="AppTitle.FontSize" Value="20"/>
          <Setter Target="TabBar.Padding" Value="0,8,0,8"/>
        </VisualState.Setters>
      </VisualState>
      <VisualState x:Name="Tablet">
        <VisualState.StateTriggers>
          <AdaptiveTrigger MinWindowWidth="641"/>
        </VisualState.StateTriggers>
        <VisualState.Setters>
          <Setter Target="AppBar.Padding" Value="{StaticResource SpacingM}"/>
          <Setter Target="AppTitle.FontSize" Value="24"/>
          <Setter Target="TabBar.Padding" Value="0,8,0,8"/>
        </VisualState.Setters>
      </VisualState>
      <VisualState x:Name="Desktop">
        <VisualState.StateTriggers>
          <AdaptiveTrigger MinWindowWidth="1008"/>
        </VisualState.StateTriggers>
        <VisualState.Setters>
          <Setter Target="AppBar.Padding" Value="{StaticResource SpacingL}"/>
          <Setter Target="AppTitle.FontSize" Value="28"/>
        </VisualState.Setters>
      </VisualState>
    </VisualStateGroup>
  </VisualStateManager.VisualStateGroups>

  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- Top AppBar with Acrylic Effect -->
    <Border Grid.Row="0"
            x:Name="AppBarBorder"
            Background="{StaticResource AcrylicBrush}"
            Padding="{StaticResource SpacingM}"
            CornerRadius="0,0,16,16">
      <Border.Background>
        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
          <GradientStop Color="#F0FFFFFF" Offset="0"/>
          <GradientStop Color="#E8F0F8FF" Offset="1"/>
        </LinearGradientBrush>
      </Border.Background>
      

      <Grid ColumnDefinitions="Auto,*" ColumnSpacing="{StaticResource SpacingM}">
        <!-- Title -->
        <TextBlock Grid.Column="0"
                   x:Name="AppTitle"
                   Text="Tech Store"
                   Style="{StaticResource Heading2Style}"
                   VerticalAlignment="Center"
                   Foreground="{StaticResource PrimaryBrush}"
                   FontWeight="Bold"/>

        <!-- Search Bar -->
        <Border Grid.Column="1"
                Background="{StaticResource SurfaceBrush}"
                Padding="12,0"
                CornerRadius="{StaticResource BorderRadiusMedium}"
                BorderThickness="2"
                BorderBrush="{StaticResource BorderBrush}"
                MaxWidth="500"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Center">
          <Grid ColumnDefinitions="Auto,*" ColumnSpacing="10">
            <SymbolIcon Grid.Column="0"
                        Symbol="Find"
                        Foreground="{StaticResource PrimaryBrush}"
                        Width="18"
                        Height="18"
                        VerticalAlignment="Center"/>
            <TextBox Grid.Column="1"
                     x:Name="GlobalSearchBox"
                     PlaceholderText="Search products..."
                     BorderThickness="0"
                     Background="Transparent"
                     FontSize="{StaticResource FontSizeBody}"
                     Foreground="{StaticResource TextPrimaryBrush}"
                     VerticalAlignment="Center"
                     MinHeight="40"
                     TextChanged="GlobalSearchBox_TextChanged"/>
          </Grid>
        </Border>
      </Grid>
    </Border>

    <!-- Main Content Frame -->
    <Frame x:Name="ContentFrame"
           Grid.Row="1"
           Background="Transparent"
           Opacity="0"
           RenderTransformOrigin="0.5,0.5">
      <Frame.RenderTransform>
        <TranslateTransform X="20"/>
      </Frame.RenderTransform>
      <Frame.ContentTransitions>
        <TransitionCollection>
          <ContentThemeTransition/>
        </TransitionCollection>
      </Frame.ContentTransitions>
    </Frame>

    <!-- Bottom Tab Bar with Acrylic Effect -->
    <Border Grid.Row="2"
            x:Name="TabBar"
            Background="{StaticResource AcrylicBrush}"
            Padding="0,8,0,8"
            CornerRadius="16,0,0,0"
            BorderThickness="1,1,0,0"
            BorderBrush="{StaticResource BorderBrush}">
      <Border.Background>
        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
          <GradientStop Color="#F0FFFFFF" Offset="0"/>
          <GradientStop Color="#F8FFFFFF" Offset="1"/>
        </LinearGradientBrush>
      </Border.Background>

      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Home Tab -->
        <Button Grid.Column="0"
                x:Name="HomeTab"
                Style="{StaticResource IconButtonStyle}"
                Click="HomeTab_Click"
                Tag="Home"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch">
          <StackPanel Spacing="4" HorizontalAlignment="Center" VerticalAlignment="Center">
            <SymbolIcon x:Name="HomeIcon"
                       Symbol="Home"/>
            <TextBlock Text="Home"
                      FontSize="10"
                      HorizontalAlignment="Center"
                      TextWrapping="Wrap"/>
            <Border x:Name="HomeIndicator"
                   Height="3"
                   Width="30"
                   Background="{StaticResource PrimaryBrush}"
                   CornerRadius="1.5"
                   HorizontalAlignment="Center"
                   Opacity="1"
                   Margin="0,4,0,0"/>
          </StackPanel>
        </Button>

        <!-- Cart Tab -->
        <Button Grid.Column="1"
                x:Name="CartTab"
                Style="{StaticResource IconButtonStyle}"
                Click="CartTab_Click"
                Tag="Cart"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch">
          <StackPanel Spacing="4" HorizontalAlignment="Center" VerticalAlignment="Center">
            <Grid>
              <SymbolIcon x:Name="CartIcon"
                         Symbol="Shop"/>
              <!-- Cart Badge -->
              <Border x:Name="CartBadge"
                     Background="{StaticResource SecondaryBrush}"
                     CornerRadius="10"
                     Padding="4,2"
                     HorizontalAlignment="Right"
                     VerticalAlignment="Top"
                     Margin="0,-8,0,0"
                     Visibility="Collapsed">
                <TextBlock x:Name="CartBadgeText"
                          Text="0"
                          Foreground="White"
                          FontSize="9"
                          FontWeight="Bold"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"
                          MinWidth="16"/>
              </Border>
            </Grid>
            <TextBlock Text="Cart"
                      FontSize="10"
                      HorizontalAlignment="Center"
                      TextWrapping="Wrap"/>
            <Border x:Name="CartIndicator"
                   Height="3"
                   Width="30"
                   Background="{StaticResource PrimaryBrush}"
                   CornerRadius="1.5"
                   HorizontalAlignment="Center"
                   Opacity="0"
                   Margin="0,4,0,0"/>
          </StackPanel>
        </Button>

        <!-- Settings Tab -->
        <Button Grid.Column="2"
                x:Name="SettingsTab"
                Style="{StaticResource IconButtonStyle}"
                Click="SettingsTab_Click"
                Tag="Settings"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch">
          <StackPanel Spacing="4" HorizontalAlignment="Center" VerticalAlignment="Center">
            <SymbolIcon x:Name="SettingsIcon"
                       Symbol="Setting"/>
            <TextBlock Text="Settings"
                      FontSize="10"
                      HorizontalAlignment="Center"
                      TextWrapping="Wrap"/>
            <Border x:Name="SettingsIndicator"
                   Height="3"
                   Width="30"
                   Background="{StaticResource PrimaryBrush}"
                   CornerRadius="1.5"
                   HorizontalAlignment="Center"
                   Opacity="0"
                   Margin="0,4,0,0"/>
          </StackPanel>
        </Button>
      </Grid>
    </Border>
  </Grid>
</Page>

