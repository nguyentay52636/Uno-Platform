<Page x:Class="Uno_Platform.Views.ProductDetailPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:components="using:Uno_Platform.Components"
      xmlns:converters="using:Uno_Platform.Converters"
      Background="{StaticResource BackgroundGradientBrush}">
  
  <Page.Resources>
    <!-- Page Enter Animation -->
    <Storyboard x:Name="PageEnterAnimation">
      <DoubleAnimation Storyboard.TargetName="ContentGrid"
                      Storyboard.TargetProperty="Opacity"
                      From="0"
                      To="1"
                      Duration="0:0:0.5">
        <DoubleAnimation.EasingFunction>
          <CubicEase EasingMode="EaseOut"/>
        </DoubleAnimation.EasingFunction>
      </DoubleAnimation>
    </Storyboard>
    
    <!-- Image Fade In Animation -->
    <Storyboard x:Name="ImageFadeIn">
      <DoubleAnimation Storyboard.TargetName="ProductImage"
                      Storyboard.TargetProperty="Opacity"
                      From="0"
                      To="1"
                      Duration="0:0:0.8">
        <DoubleAnimation.EasingFunction>
          <CubicEase EasingMode="EaseOut"/>
        </DoubleAnimation.EasingFunction>
      </DoubleAnimation>
      <DoubleAnimation Storyboard.TargetName="ProductImage"
                      Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                      From="0.9"
                      To="1.0"
                      Duration="0:0:0.8">
        <DoubleAnimation.EasingFunction>
          <CubicEase EasingMode="EaseOut"/>
        </DoubleAnimation.EasingFunction>
      </DoubleAnimation>
      <DoubleAnimation Storyboard.TargetName="ProductImage"
                      Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                      From="0.9"
                      To="1.0"
                      Duration="0:0:0.8">
        <DoubleAnimation.EasingFunction>
          <CubicEase EasingMode="EaseOut"/>
        </DoubleAnimation.EasingFunction>
      </DoubleAnimation>
    </Storyboard>
  </Page.Resources>

  <Grid x:Name="ContentGrid" Opacity="0">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <!-- Header with Acrylic Background -->
    <Border Grid.Row="0"
            Background="{StaticResource AcrylicBrush}"
            Padding="{StaticResource SpacingL}"
            BorderThickness="0,0,0,1"
            BorderBrush="{StaticResource BorderBrush}">
      <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="{StaticResource SpacingM}">
        <Button Grid.Column="0"
                Style="{StaticResource IconButtonStyle}"
                Background="{StaticResource SurfaceBrush}"
                Foreground="{StaticResource PrimaryBrush}"
                CornerRadius="{StaticResource BorderRadiusMedium}"
                Width="48"
                Height="48"
                Command="{x:Bind ViewModel.GoBackCommand}">
          <SymbolIcon Symbol="Back"/>
        </Button>
        
        <TextBlock Grid.Column="1"
                  Text="Product Details"
                  Style="{StaticResource Heading2Style}"
                  VerticalAlignment="Center"
                  Foreground="{StaticResource TextPrimaryBrush}"/>
      </Grid>
    </Border>

    <!-- Content -->
    <ScrollViewer Grid.Row="1" 
                  Padding="{StaticResource SpacingL}"
                  ZoomMode="Disabled"
                  VerticalScrollBarVisibility="Auto"
                  HorizontalScrollBarVisibility="Disabled">
      <StackPanel Spacing="{StaticResource SpacingL}" MaxWidth="1000">
        
        <!-- Large Product Image Card -->
        <Border Background="{StaticResource AcrylicBrush}"
                Padding="{StaticResource SpacingXL}"
                CornerRadius="{StaticResource BorderRadiusXLarge}"
                BorderThickness="2"
                BorderBrush="{StaticResource BorderBrush}">
          <Grid>
            <!-- Gradient Background -->
            <Border Background="{StaticResource PrimaryGradientBrush}"
                    CornerRadius="{StaticResource BorderRadiusLarge}"
                    Opacity="0.1"/>
            
            <!-- Image Container -->
            <Border Background="{StaticResource SurfaceBrush}"
                    CornerRadius="{StaticResource BorderRadiusLarge}"
                    Padding="{StaticResource SpacingXL}">
              <Grid>
                <Image x:Name="ProductImage"
                       Source="Assets/img/caby.png"
                 Stretch="Uniform"
                 HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       MaxHeight="500"
                       MaxWidth="500"
                       Opacity="0"
                       RenderTransformOrigin="0.5,0.5">
                  <Image.RenderTransform>
                    <ScaleTransform/>
                  </Image.RenderTransform>
                </Image>
                
                <!-- Category Badge Overlay -->
                <Border Background="{StaticResource PrimaryGradientBrush}"
                       CornerRadius="20"
                       Padding="16,8"
                       HorizontalAlignment="Right"
                       VerticalAlignment="Top"
                       Margin="16"
                       Opacity="0.95">
              <TextBlock Text="{x:Bind ViewModel.Product.Category, Mode=OneWay}"
                        Foreground="White"
                            FontSize="14"
                            FontWeight="Bold"/>
                </Border>
              </Grid>
            </Border>
          </Grid>
        </Border>

        <!-- Product Info Card -->
        <Border Background="{StaticResource AcrylicBrush}"
                Padding="{StaticResource SpacingXL}"
                CornerRadius="{StaticResource BorderRadiusXLarge}"
                BorderThickness="2"
                BorderBrush="{StaticResource BorderBrush}">
          <StackPanel Spacing="{StaticResource SpacingL}">

            <!-- Product Name -->
            <TextBlock Text="{x:Bind ViewModel.Product.Name, Mode=OneWay}"
                      Style="{StaticResource Heading1Style}"
                      FontSize="36"
                      FontWeight="Bold"
                      TextWrapping="Wrap"
                      Foreground="{StaticResource TextPrimaryBrush}"/>

            <!-- Price Section -->
            <Border Background="{StaticResource AccentBrush}"
                   CornerRadius="{StaticResource BorderRadiusLarge}"
                   Padding="{StaticResource SpacingL}"
                   Margin="0,16,0,0"
                   HorizontalAlignment="Left">
              <StackPanel Orientation="Horizontal" Spacing="12">
                <TextBlock Text="ðŸ’°"
                          FontSize="32"
                          VerticalAlignment="Center"/>
            <TextBlock Text="{x:Bind ViewModel.Product.Price, Mode=OneWay, Converter={StaticResource PriceFormatConverter}}"
                          Foreground="White"
                          FontSize="48"
                          FontWeight="Bold"
                          VerticalAlignment="Center"/>
              </StackPanel>
            </Border>

          </StackPanel>
        </Border>

        <!-- Category & Description Card -->
        <Border Background="{StaticResource AcrylicBrush}"
                Padding="{StaticResource SpacingXL}"
                CornerRadius="{StaticResource BorderRadiusXLarge}"
                BorderThickness="2"
                BorderBrush="{StaticResource BorderBrush}">
          <StackPanel Spacing="{StaticResource SpacingL}">
            
            <!-- Category Section -->
            <StackPanel Spacing="{StaticResource SpacingS}">
              <TextBlock Text="Category"
                        Style="{StaticResource Heading3Style}"
                        Foreground="{StaticResource TextSecondaryBrush}"
                        FontSize="14"
                        FontWeight="SemiBold"/>
              <Border Background="{StaticResource PrimaryBrush}"
                     CornerRadius="{StaticResource BorderRadiusMedium}"
                     Padding="16,10"
                     HorizontalAlignment="Left"
                     Opacity="0.9">
                <TextBlock Text="{x:Bind ViewModel.Product.Category, Mode=OneWay}"
                          Foreground="White"
                          FontSize="{StaticResource FontSizeBody}"
                          FontWeight="SemiBold"/>
              </Border>
            </StackPanel>

            <!-- Description Section -->
            <StackPanel Spacing="8" Margin="0,16,0,0">
              <TextBlock Text="Description"
                        Style="{StaticResource Heading3Style}"
                        Foreground="{StaticResource TextSecondaryBrush}"
                        FontSize="14"
                        FontWeight="SemiBold"/>
              <Border Background="{StaticResource SurfaceBrush}"
                     CornerRadius="{StaticResource BorderRadiusLarge}"
                     Padding="{StaticResource SpacingL}"
                     BorderThickness="1"
                     BorderBrush="{StaticResource BorderBrush}">
            <TextBlock Text="{x:Bind ViewModel.Product.Description, Mode=OneWay}"
                      Style="{StaticResource BodyTextStyle}"
                      TextWrapping="Wrap"
                          LineHeight="28"
                          FontSize="{StaticResource FontSizeBody}"
                          Foreground="{StaticResource TextPrimaryBrush}"/>
              </Border>
            </StackPanel>

          </StackPanel>
        </Border>

        <!-- Action Buttons Card -->
        <Border Background="{StaticResource AcrylicBrush}"
                Padding="{StaticResource SpacingXL}"
                CornerRadius="{StaticResource BorderRadiusXLarge}"
                BorderThickness="2"
                BorderBrush="{StaticResource BorderBrush}">
          <Grid ColumnDefinitions="*,*" ColumnSpacing="{StaticResource SpacingM}">
            
            <!-- Edit Product Button -->
            <Button Grid.Column="0"
                   Content="âœï¸ Edit Product"
                   Style="{StaticResource PrimaryButtonStyle}"
                   Background="#6366F1"
                   Height="60"
                   Command="{x:Bind ViewModel.NavigateToEditCommand}"/>

            <!-- Add to Cart Button -->
            <Button Grid.Column="1"
                   Content="ðŸ›’ Add to Cart"
                   Style="{StaticResource PrimaryButtonStyle}"
                   Background="#10B981"
                   Height="60"
                   Command="{x:Bind ViewModel.AddToCartCommand}"/>

          </Grid>
        </Border>

      </StackPanel>
    </ScrollViewer>

    <!-- Loading Overlay -->
    <components:LoadingIndicator Grid.Row="1"
                                IsLoading="{x:Bind ViewModel.IsLoading, Mode=OneWay}"
                                Message="Loading product details..."/>
  </Grid>
</Page>
